# APISCAN  OWASP API Security Scanner

**Version:** 1.0 (Release)  
**Author:** Perry Mertens ([pamsniffer@gmail.com](mailto:pamsniffer@gmail.com))  
**License:** MIT

APISCAN is an extensible, AIaware API security scanner targeting the **OWASP API Security Top 10 (2023)**.  
It understands Swagger/OpenAPI, supports multiple authentication flows (incl. OAuth2, NTLM, mTLS), and produces clean HTML reports.

---

## What's New in v1.0

- **Expanded Authentication Flows**: `--flow none|token|client|basic|ntlm|auth` with support for `--client-id`, `--client-secret`, `--token-url`, `--auth-url`, `--redirect-uri`, `--scope`, plus optional mTLS (`--client-cert`, `--client-key`, `--cert-password`).
- **Faster Scans**: Threadpool parallelism (`--threads`, up to 20) and HTTP connection pooling.
- **AIAssisted Audit (API11)**: Optional `--api11` analysis runs an AI pass and saves results to `AI-api11_scanresults.json`.
- **Smart Swagger Integration**: Safer dummy mode (`--dummy`) and a new exporter `--export_vars PATH` (YAML/JSON).
- **Rich Reporting**: Perrisk HTML reports + autogenerated `combined_report.html`, dedicated log folder per run, and terminal risk summary.
- **Connectivity Guard**: Preflight reachability checks with retries and clear TLS/auth error handling.

---

## Key Features

- OpenAPIaware active scanning (real requests)
- Coverage for API1..API10 + **API11: AIassisted review**
- Multiauth: bearer token, OAuth2 client, basic, NTLM, API key header, mTLS
- Dummy mode: schemaaware fake values for safe testing
- Variables export: fillin templates (YAML/JSON)
- Perrisk HTML + combined report

---

## Supported Risks

| ID    | Description                                       | Module                           |
|-------|---------------------------------------------------|----------------------------------|
| API1  | Broken Object Level Authorization                 | `bola_audit.py`                  |
| API2  | Broken Authentication                             | `broken_auth_audit.py`           |
| API3  | Property Level Authorization                      | `broken_object_property_audit.py`|
| API4  | Unrestricted Resource Consumption                 | `resource_consumption_audit.py`  |
| API5  | Function Level Authorization                      | `authorization_audit.py`         |
| API6  | Sensitive Business Logic                          | `business_flow_audit.py`         |
| API7  | SSRF (ServerSide Request Forgery)                | `ssrf_audit.py`                  |
| API8  | Security Misconfiguration                         | `misconfiguration_audit.py`      |
| API9  | Improper Inventory Management                     | `inventory_audit.py`             |
| API10 | Unsafe Consumption of 3rdParty APIs              | `safe_consumption_audit.py`      |
| API11 | AIassisted Security Analysis                     | `ai_client.py`                   |

---

## Install

```bash
python -m venv .venv && . .venv/bin/activate   # (Windows: .venv\Scripts\activate)
pip install -r requirements.txt
```

> Python 3.11+ recommended.

---

## Quick Start

```bash
# Real mode (production/test data)
python apiscan.py \
  --url https://api.example.com \
  --swagger openapi.json \
  --flow token \
  --token <BEARER>

# Dummy mode (schemaaware fake values)
python apiscan.py \
  --url https://api.example.com \
  --swagger openapi.json \
  --flow token \
  --token <BEARER> \
  --dummy
```

---

## Export Variables Template

```bash
python apiscan.py \
  --url https://api.example.com \
  --swagger openapi.json \
  --export_vars vars_template.yml
```

---

## Swagger/OpenAPI Crawler

```bash
python swagger_generator.py \
  --url https://api.example.com \
  --output openapi.json \
  --depth 3 \
  --aggressive
```

---

## Outputs

- `api_*.html`  one per risk
- `combined_report.html`  merged overview
- `AI-api11_scanresults.json`  AI output
- Logs in `audit_*/log/*.log`

---

## CLI Arguments (summary, v1.0)

```
--url                 Base API URL
--swagger             Path to OpenAPI/Swagger JSON
--flow                none | token | client | basic | ntlm | auth
--token               Bearer token
--basic-auth          user:pass
--apikey              API key
--apikey-header       API key header (default: X-API-Key)
--ntlm                DOMAIN\user:pass
--client-cert         PEM client certificate
--client-key          PEM private key
--cert-password       Password for private key (optional)
--insecure            Disable TLS verification (DANGEROUS)
--client-id           OAuth2 Client ID
--client-secret       OAuth2 Client Secret
--token-url           OAuth2 Token endpoint
--auth-url            OAuth2 Authorization endpoint
--redirect-uri        OAuth2 redirect URI
--scope               OAuth2 scopes
--threads             Parallelism (default 2, max 20)
--dummy               Enable dummy payloads
--export_vars PATH    Write a variables template
--api1..--api11       Run specific audits
--debug               Verbose logging
```

---

## Disclaimer

## APISCAN is a private and proprietary API security tool, developed independently for internal use and research purposes.
## It supports OWASP API Security Top 10 (2023) testing, OpenAPI-based analysis, active scanning, and multi-format reporting.
## Redistribution is not permitted without explicit permission.

## Important: Testing with APISCAN is only permitted on systems and APIs for which you have explicit authorization. Unauthorized testing is strictly prohibited.

---

## Contact

-  [pamsniffer@gmail.com](mailto:pamsniffer@gmail.com)
-  GitHub: <https://github.com/perrym/apiscanner>
